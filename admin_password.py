import gui


def check_admin_password(window):
    password = window.get_input("Enter Password:")
    pass_fail = True

    filepath = gui.resource_path('common_password_list')
    with open(filepath) as fp:
        for test, line in enumerate(fp):
            line = fp.readline()
            line = line.rstrip('\n')
            if line == password:
                pass_fail = False
                break

    if not pass_fail:
        link = "<a href='https://support.microsoft.com/en-us/help/" \
               "4490115/windows-change-or-reset-your-password'>Link</a>"
        output = (
            False,
            "Your Administrator password matches on of "
            "the top 500 most common passwords. "
            "Follow the steps here: {}, "
            "to change it to something more secure.".format(link))
    else:
        output = (
            True,
            "Your Administrator password does not match "
            "the top 500 most common passwords.")

    return output
