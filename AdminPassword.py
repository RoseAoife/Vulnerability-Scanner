from PyQt5.QtCore import QDir
from PyQt5.QtWidgets import QApplication, QWidget, QInputDialog, QLineEdit


def check_admin_password(gui):
    # import the variable from the password form as "password"
    password = gui.getInput("Enter Password:")
    pass_fail = True

    filepath = 'common_password_list'
    with open(filepath) as fp:
        for test, line in enumerate(fp):
            line = fp.readline()
            #remove troublesome whitespace characters
            line = line.rstrip('\n')
            print(line)
            if(line == password):
                pass_fail = False
                break

    if not pass_fail:
        output = (False, "Your Administrator password matches on of the top 500 most common passwords. "
                  "Follow the steps here: https://support.microsoft.com/en-us/help/4490115/windows-change-or-reset-your-password "
                  "to change it to something more secure.")
    else:
        output = (True, "Your Administrator password does not match the top 500 most common passwords. Passed test.")

    return output

