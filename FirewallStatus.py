import os


def check_firewall_status():

    firewall_status = ["OFF", "OFF", "OFF"]
    text = os.popen('netsh advfirewall show allprofiles').read().split('\n')

    current = 0
    for line in text:
        if "State" in line and "ON" in line:
            firewall_status[current] = "ON"
            current += 1
        elif "State" in line and "OFF" in line:
            firewall_status[current] = "OFF"
            current += 1

    if "OFF" in firewall_status:
        output = (False, "Your firewall is currently off, leaving your computer more vulnerable to attack. "
                         "Follow the steps here: https://support.microsoft.com/en-us/help/4028544/windows-10-turn"
                         "-microsoft-defender-firewall-on-or-off to turn it on.")
    else:
        output = (True, "Your firewall is currently on. Passed test.")

    return output