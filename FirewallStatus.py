import subprocess

def check_firewall_status():
    firewall_status = ["OFF", "OFF", "OFF"]
    DEVNULL = subprocess.DEVNULL
    text = subprocess.Popen('netsh advfirewall show allprofiles', shell=True, stderr = DEVNULL , stdin = DEVNULL)
    text_string = str(text, "utf-8")
    text_string_split = text_string.split('\n')

    current = 0
    for line in text_string_split:
        if "State" in line and "ON" in line:
            firewall_status[current] = "ON"
            current += 1
        elif "State" in line and "OFF" in line:
            firewall_status[current] = "OFF"
            current += 1

    if "OFF" in firewall_status:
        link = "<a href='https://support.microsoft.com/en-us/help/4028544/windows-10-turn'>Link</a>"
        output = (False, "Your firewall is currently off, leaving your computer more vulnerable to attack. "
                         "Follow the steps here: {},}"
                         "-microsoft-defender-firewall-on-or-off to turn it on.".format(link))
    else:
        output = (True, "Your firewall is currently on.")

    return output
